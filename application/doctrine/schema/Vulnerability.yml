Vulnerability:
    listeners: [XssListener, IndexListener, NotificationListener]
    
    columns:
        createdTs: timestamp
    
        discoveredDate:
            type: date
            comment: The date when the finding was discovered. This is self-reported by users
            extra:
                auditLog: true
                logicalName: Date Discovered
        closedTs:
            type: timestamp
            comment: The timestamp when this finding was closed
            extra:
                logicalName: Closed Date
            
        status:
            type: enum
            values: [OPEN, AR, FP, CLOSED]
            extra:
                searchIndex: unstored
            comment: The current status.
            
        description:
            type: string
            extra: 
                purify: html
                auditLog: true
                logicalName: Vulnerability Description
                searchIndex: unstored
        recommendation:
            type: string
            extra: 
                purify: html
                auditLog: true
                logicalName: Recommendation
                searchIndex: unstored
        threat:
            type: string
            extra: 
                purify: html
                auditLog: true
                logicalName: Description of Threat Source
                searchIndex: unstored
            comment: Description of the threat source which affects this vulnerability
        threatLevel:
            type: enum
            values: [LOW, MODERATE, HIGH]
            extra:
                auditLog: true
                logicalName: Threat Level
                searchIndex: unstored
            comment: A subjective assessment of the probability and impact of exploiting this vulnerability
        cvssBaseScore:
           type: float
           extra:
                auditLog: true
                logicalName: CVSS Base Score
                searchIndex: unstored
           comment: The CVSS Base Score of the vulnerability
        cvssVector:
            type: string(255)
            comment: The CVSS Vector of the vulnerability
            extra:
                auditLog: true
                logicalName: CVSS Vector
                searchIndex: unstored

        duplicateVulnerabilityId:
            type: integer
            comment: If this vulnerability is a duplicate of an existing vulnerability, then this is a foreign key to that vulnerability; otherwise its null
        assetId:
            type: integer
            comment: Foreign key to the asset which this vulnerability is against
        createdByUserId:
            type: integer
            comment: Foreign key to the user who created this vulnerability
        uploadId:
            type: integer
            comment: Foreign key to the upload log

    indexes:
        descriptionindex:
            fields:
                description:
                    length: 20

    relations:
        DuplicateVulnerability:
            class: Vulnerability
            local: duplicateVulnerabilityId
            foreign: id
        Asset:
            local: assetId
            foreign: id
            foreignAlias: Vulnerabilities
        CreatedBy:
            class: User
            local: createdByUserId
            foreign: id
            foreignAlias: Vulnerabilities
        Upload:
            local: uploadId
            foreign: id
            foreignAlias: Vulnerabilities
        Cves:
            class: Cve
            local: vulnerability_id
            foreign: cve_id
            refClass: VulnerabilityCve
        Bugtraqs:
            class: Bugtraq
            local: vulnerability_id
            foreign: bugtraq_id
            refClass: VulnerabilityBugtraq
        Xrefs:
            class: Xref
            local: vulnerability_id
            foreign: xref_id
            refClass: VulnerabilityXref

    actAs:
        Timestampable:
            created:
                name: createdTs
                type: timestamp
            updated:
                name: modifiedTs
                type: timestamp
        
        Fisma_Doctrine_Behavior_AuditLoggable:
            logCreateObject: true
            logUpdateField: true
            logDeleteObject: true
        
        Fisma_Doctrine_Behavior_Commentable: true
        
        SoftDelete: true
