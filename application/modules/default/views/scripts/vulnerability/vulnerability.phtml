<?php
    $vulnerability = $this->vulnerability;
?>
<div>
    <?php Fisma_Format_Section::startSection("Details"); ?>
    <table class="keyValues">
        <tr>
            <td>Vulnerability ID:</td>
            <td><?php echo $this->escape($vulnerability->id)?></td>
        </tr>
        <tr>
            <td>Date Discovered:</td>
            <td><?php echo $this->escape($vulnerability->discoveredDate)?></td>
        </tr>
        <tr>
            <td>Date Opened:</td>
            <td><?php echo $this->escape($vulnerability->createdTs)?></td>
        </tr>
        <tr>
            <td>Date Closed:</td>
            <td>
                <?php 
                if (!is_null($vulnerability->closedTs)) {
                    echo $this->escape($vulnerability->closedTs);
                } else {
                    echo $this->escape("<i>Not closed</i>", 'none');
                }
                ?>
            </td>
        </tr>
        <tr>
            <td>Status:</td>
            <td><?php echo $this->escape($vulnerability->status)?></td>
        </tr>
        <?php $dupVulnId = $this->vulnerability->duplicateVulnerabilityId; ?>
        <?php if ($dupVulnId != null): ?>
        <tr>
            <td>Duplicate of:</td>
            <td>
                <a href="/vulnerability/view/id/<?php echo $this->escape($dupVulnId);?>">
                    Vulnerability <?php echo $this->escape($dupVulnId);?>
                </a>
            </td>
        </tr>
        <?php endif ?>
    </table>
    <?php Fisma_Format_Section::stopSection(); ?>
</div>

<div class="clear"></div>

<?php Fisma_Format_Section::startSection('Description'); ?>
<div> 
    <?php echo $this->escape($vulnerability->description, 'none'); ?>
</div>
<?php Fisma_Format_Section::stopSection(); ?>

<?php Fisma_Format_Section::startSection('Recommendation'); ?>
<div>
    <?php echo $this->escape($vulnerability->recommendation, 'none'); ?>
</div>
<?php Fisma_Format_Section::stopSection(); ?>

