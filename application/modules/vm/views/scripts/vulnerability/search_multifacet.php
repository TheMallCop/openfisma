<form method="post" action="" onsubmit="Fisma.Search.handleSearchEvent(this);
        return false;" enctype="application/x-www-form-urlencoded" id="searchFacetForm">
    <span>

        <button type="submit" class="ui-button-text left">Filter</button>
        
        <input type="hidden" id="searchType" value="advanced" name="searchType">

        <input type="hidden" id="modelName" value="Vulnerability" name="modelName">

        <input type="hidden" title="Keyword Search" value="" id="keywords" name="keywords">

    </span>
    <?php
    //create a criterion/range.phtml for Score, allow the user to search through a range of scores
    echo new Fisma_Criterion(array(
        'type' => 'range',
        'name' => 'cvssbasescore',
        'label' => 'Score',
        'unit' => 'score',
        
    ));
  
    echo new Fisma_Criterion(array(
        'type' => 'enum',
        'name' => 'threatlevel',
        'label' => 'Severity',
        'value' => array_fill_keys($this->severity_list, false)
    ));
    
    echo new Fisma_Criterion(array(
    'type' => 'enum',
    'name' => 'currentstepid',
    'label' => 'Workflow Step',
    'value' => array_fill_keys($this->escape($this->workflow_steps,'none'), false)

    ));

    echo new Fisma_Criterion(array(
        'type' => 'enum',
        'name' => 'networkId',
        'label' => 'Network',
        'value' => array_fill_keys($this->escape($this->networks, 'none'), false)
    ));
    
    echo new Fisma_Criterion(array(
    'type' => 'organization',
    'name' => 'organization',
    'label' => 'Organization / System',
    'value' => array(
        'text' => 'NRL',
        'self' => false,
        'children' => 'all',
        'tree' => 'organization'
    ),
    //'checked' => true
    ));
    
  echo new Fisma_Criterion(array(
      'type' => 'text',
      'name' => 'pocid',
      'label' => 'Assignee'
  ));
    
   echo new Fisma_Criterion(array(
        'type' => 'text',
        'name' =>'assetid',
        'label' => 'Asset IP Address'
    ));
    
    echo new Fisma_Criterion(array(
    'type' => 'enum',
    'name' => 'source',
    'label' => 'Source',
    'value' => array_fill_keys($this->escape($this->source_list,'none'), false)
    ));

    // special criterion for cvss vector
    
    echo new Fisma_Criterion(array(
        'type' => 'cvssvector',
        'name' => 'cvssvector',
        'label' => 'CVSS Details'
    ));
    
    echo new Fisma_Criterion(array(
        'type' => 'date_group',
        'name' => 'createdts',
        'label' => 'Days old',
        'value' => $this->days_old
    ));
?>
</form>