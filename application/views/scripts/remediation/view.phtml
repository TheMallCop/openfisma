<div id="tabContainer"></div>

<script type="text/javascript">
    YAHOO.util.Event.onDOMReady(function () {
        var tabView = new YAHOO.widget.TabView();
        
        // When a tab is loaded for the first time, this function is called to set up highlighting and editable fields
        var prepareTab = function(args) {
            highlight(document.getElementById("tabContainer"), 
                      "<?php echo $this->keywords; ?>");
            setupEditFields();        
        }
        
        // Finding tab
        var findingTab = new YAHOO.widget.Tab({
            label: 'Finding #<?php echo $this->poam['id']; ?>',
            dataSrc: '/remediation/finding/id/<?php echo $this->poam['id']; ?>',
            cacheData: true
        });
        findingTab.subscribe("dataLoadedChange", prepareTab);
        tabView.addTab(findingTab);
        
        var mitigationTab = new YAHOO.widget.Tab({
            label: 'Mitigation Strategy',
            dataSrc: '/remediation/mitigation-strategy/id/<?php echo $this->poam['id']; ?>',
            cacheData: true
        });
        mitigationTab.subscribe("dataLoadedChange", prepareTab);        
        tabView.addTab(mitigationTab);
        
        var riskTab = new YAHOO.widget.Tab({
            label: 'Risk Analysis',
            dataSrc: '/remediation/risk-analysis/id/<?php echo $this->poam['id']; ?>',
            cacheData: true
        });
        riskTab.subscribe("dataLoadedChange", prepareTab);                
        tabView.addTab(riskTab);

        var artifactsTab = new YAHOO.widget.Tab({
            label: 'Artifacts (<?php echo count($this->ev_evals); ?>)',
            dataSrc: '/remediation/artifacts/id/<?php echo $this->poam['id']; ?>',
            cacheData: true
        });
        artifactsTab.subscribe("dataLoadedChange", prepareTab);                
        tabView.addTab(artifactsTab);
            
        var auditTab = new YAHOO.widget.Tab({
            label: 'Audit Log',
            dataSrc: '/remediation/audit-log/id/<?php echo $this->poam['id']; ?>',
            cacheData: true
        });
        auditTab.subscribe("dataLoadedChange", prepareTab);        
        tabView.addTab(auditTab);
     
        tabView.appendTo('tabContainer');
        
        tabView.selectTab(0);
    });
</script>

