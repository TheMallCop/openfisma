(function(){YAHOO.util.Event.onDOMReady(function(){var c=YAHOO.util.Selector.query(".date");for(var b=0;b<c.length;b++){YAHOO.util.Event.on(c[b].getAttribute("id")+"_show","click",Fisma.Calendar.callCalendar,c[b].getAttribute("id"))}});var a={addCalendarPopupToTextField:function(e){var c=document.createElement("div");c.style.position="absolute";c.style.zIndex=99;e.parentNode.appendChild(c);var d=YAHOO.util.Dom.getRegion(e);var g=[d.left,d.bottom+5];YAHOO.util.Dom.setXY(c,g);var f=new YAHOO.widget.Calendar(c,{close:true});f.hide();setTimeout(function(){f.render()},0);e.onfocus=function(){f.show()};var b=function(l,i,n){var k=i[0][0];var j=k[0],m=k[1].toString(),h=k[2].toString();if(1===m.length){m="0"+m}if(1===h.length){h="0"+h}e.value=j+"-"+m+"-"+h;f.hide()};f.selectEvent.subscribe(b,f,true)},callCalendar:function(b,c){alert("testa");this.showCalendar(c,c+"_show")},showCalendar:function(f,d){var k=YAHOO.util.Event,h=YAHOO.util.Dom,i,g;var j=h.get(d);var i;var g;if(!i){function e(){h.get(f).value="";b()}function b(){i.hide()}i=new YAHOO.widget.Dialog("container",{visible:false,context:[f,"tl","bl"],draggable:true,close:true});i.setHeader("Pick A Date");i.setBody('<div id="cal"></div><div class="clear"></div>');i.render(document.body);dialogEl=document.getElementById("container");dialogEl.style.padding="0px";i.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){i.fireEvent("changeContent")}})}if(!g){g=new YAHOO.widget.Calendar("cal",{iframe:false,hide_blank_weeks:true});g.render();g.selectEvent.subscribe(function(){if(g.getSelectedDates().length>0){var m=g.getSelectedDates()[0];var l=(m.getDate()<10)?"0"+m.getDate():m.getDate();var o=(m.getMonth()+1<10)?"0"+(m.getMonth()+1):(m.getMonth()+1);var n=m.getFullYear();h.get(f).value=n+"-"+o+"-"+l}else{h.get(f).value=""}i.hide();if("finding[currentEcd]"==h.get(f).name){validateEcd()}});g.renderEvent.subscribe(function(){i.fireEvent("changeContent")})}var c=g.getSelectedDates();if(c.length>0){g.cfg.setProperty("pagedate",c[0]);g.render()}i.show()}};Fisma.Calendar=a})();