Fisma.Remediation={uploadEvidence:function(){Fisma.UrlPanel.showPanel("Upload Evidence","/finding/remediation/upload-form",function(b){document.finding_detail_upload_evidence.action=document.finding_detail.action;new YAHOO.widget.Button("add-another-file-button"),YAHOO.util.Dom.addClass("add-another-file-button","ie7-only");YAHOO.util.Event.addListener("add-another-file-button","click",Fisma.Remediation.addUploadEvidence);var a=b.body.getElementsByTagName("input");for(var c in a){if(a[c].type==="submit"){new YAHOO.widget.Button(a[c])}}});return false},remediationAction:function(c,j){var g=j.action;var q=j.formId;var l=j.panelTitle;var h=j.findingId;if("REJECTED"===g){var a=Fisma.UrlPanel.showPanel(l,"/finding/remediation/reject-evidence/id/"+h,function(){document.finding_detail_reject_evidence.action=document.finding_detail.action;new YAHOO.widget.Button(YAHOO.util.Selector.query("input[type=submit]","finding_detail_reject_evidence",true));var p=function(){a.destroy()};new YAHOO.widget.Button("dialog_close",{onclick:{fn:p}})})}else{var i=document.createElement("div");var n=document.createElement("div");n.className="messageBox attention";var f="WARNING: This action cannot be undone.";n.appendChild(document.createTextNode(f));i.appendChild(n);var d=document.createElement("p");var k;if("APPROVED"===g){k=document.createTextNode("Comments (OPTIONAL):")}else{k=document.createTextNode("Comments:")}d.appendChild(k);i.appendChild(d);var o=document.createElement("textarea");o.id="dialog_comment";o.name="comment";o.rows=5;o.cols=60;i.appendChild(o);var b=document.createElement("div");b.className="buttonBar";i.appendChild(b);var m=document.createElement("button");m.id="dialog_continue";m.appendChild(document.createTextNode("Confirm"));b.appendChild(m);var e=document.createElement("button");e.id="dialog_close";e.style.marginLeft="5px";e.appendChild(document.createTextNode("Cancel"));b.appendChild(e);var a=Fisma.HtmlPanel.showPanel(l,i.innerHTML);new YAHOO.widget.Button("dialog_continue",{onclick:{fn:function(){var p=document.getElementById(q);var u=document.getElementById("dialog_comment").value;if("DENIED"===g){if(u.match(/^\s*$/)){var t="Comments are required.";var r={zIndex:10000};Fisma.Util.showAlertDialog(t,r);return}}p.elements.comment.value=u;p.elements.decision.value=g;var s=document.createElement("input");s.type="hidden";s.name="submit_msa";s.value=g;p.appendChild(s);p.submit();return}}});new YAHOO.widget.Button("dialog_close",{onclick:{fn:function(){a.destroy();return false}}})}return true},addUploadEvidence:function(){var a=document.getElementById("evidence_upload_file_list");var b=document.createElement("input");b.type="file";b.name="evidence[]";b.multiple=true;a.appendChild(b);return false},rejectEvidenceValidate:function(){if(document.finding_detail_reject_evidence.comment.value.match(/^\s*$/)){var b="Comments are required.";var a={zIndex:10000};Fisma.Util.showAlertDialog(b,a);return false}return true},uploadEvidenceValidate:function(){if(document.finding_detail_upload_evidence.forceSubmit){return true}var h=false;var e="WARNING: The following file(s) will be replaced: <ul>";for(var b=0;b<document.links.length;b++){var d=document.links[b];if(d.href.indexOf("downloadevidence")>=0&&d.lastChild.nodeName=="DIV"){var c=document.finding_detail_upload_evidence["evidence[]"].files;if(!c){var f=document.finding_detail_upload_evidence.elements;for(var a=0;a<f.length;a++){if(f[a].name=="forceSubmit"){return true}if(f[a].name=="evidence[]"){var g=f[a].value;g=g.slice(g.lastIndexOf("\\")+1);if(g==d.lastChild.innerHTML){h=true;e+="<li>"+g+"</li>"}}}}else{for(var a=0;a<c.length;a++){if(c[a].fileName==d.lastChild.innerHTML){h=true;e+="<li>"+c[a].fileName+"</li>";break}}}}}e+="</ul>Do you want to continue?";if(h){Fisma.Util.showConfirmDialog(event,{text:e,func:"Fisma.Remediation.uploadEvidenceConfirm"});return false}else{return true}},uploadEvidenceConfirm:function(){var a=document.createElement("input");a.type="hidden";a.name="forceSubmit";a.value=true;document.finding_detail_upload_evidence.appendChild(a);document.finding_detail_upload_evidence.upload_evidence.click()}};