Fisma.SecurityAuthorization={selectControlsTable:null,addControlPanel:null,confirmImportBaselineControls:function(b,a){confirmation={func:Fisma.SecurityAuthorization.importBaselineControls,args:[a],text:"Are you sure you want to import the baseline controls for this information system?"};Fisma.Util.showConfirmDialog(null,confirmation)},importBaselineControls:function(a){var d="<img src='/images/loading_bar.gif'>";var b={width:"20em",modal:true,close:false};var c=Fisma.HtmlPanel.showPanel("Importing baseline controls…",d,null,b);YAHOO.util.Connect.asyncRequest("GET","/sa/security-authorization/import-baseline-security-controls/id/"+a+"/format/json",{success:function(i){try{var f=YAHOO.lang.JSON.parse(i.responseText).response;if(f.success){var e=document.getElementById("no-security-controls-warning");if(e){e.style.display="none"}var h=Fisma.SecurityAuthorization.selectControlsTable;h.showTableMessage("Loading baseline controls...");h.getDataSource().sendRequest("",{success:h.onDataReturnInitializeTable,scope:h});h.on("dataReturnEvent",function(){c.destroy()})}else{Fisma.Util.showAlertDialog("An error occurred: "+f.message);c.destroy()}}catch(g){Fisma.Util.showAlertDialog("An unexpected error occurred: "+g);c.destroy()}},failure:function(e){Fisma.Util.showAlertDialog("An unexpected error occurred.");c.destroy()}},null)},showPanel:function(b){var a=new YAHOO.widget.Panel("panel",{modal:true,close:true});a.setHeader("Select System");a.setBody("Loading...");a.render(document.body);a.center();a.show();a.hideEvent.subscribe(function(){Fisma.SecurityAuthorization.cancelPanel.call(Fisma.SecurityAuthorization)});Fisma.SecurityAuthorization.yuiPanel=a;var c="/system/create/format/html";YAHOO.util.Connect.asyncRequest("GET",c,{success:function(d){d.argument.setBody(d.responseText);d.argument.center()},failure:function(d){d.argument.setBody("The content for this panel could not be loaded.");d.argument.center()},argument:a},null)},completeForm:function(a){document.getElementById("completeForm").submit()},addControl:function(b){var a=Fisma.SecurityAuthorization.addControlPanel;YAHOO.util.Connect.setForm(b);YAHOO.util.Connect.asyncRequest("POST","/sa/security-authorization/add-control/format/json",{success:function(g){try{var d=YAHOO.lang.JSON.parse(g.responseText).response;if(d.success){var c=document.getElementById("no-security-controls-warning");if(c){c.style.display="none"}var f=Fisma.SecurityAuthorization.selectControlsTable;f.showTableMessage("Updating list of controls…");f.getDataSource().sendRequest("",{success:f.onDataReturnInitializeTable,scope:f});f.on("dataReturnEvent",function(){a.destroy()})}else{Fisma.Util.showAlertDialog("An error occurred: "+d.message);a.destroy()}}catch(e){Fisma.Util.showAlertDialog("An unexpected error occurred: "+e);a.destroy()}},failure:function(c){Fisma.Util.showAlertDialog("An unexpected error occurred.");a.destroy()}},null)},showAddControlForm:function(d,e){var f=e,a=Fisma.HtmlPanel.showPanel("Add Security Control",null,null,{modal:true}),b="/sa/security-authorization/show-add-control-form/format/html/id/"+f;var c={success:function(h){var g=h.argument;g.setBody(h.responseText);g.center()},failure:function(h){alert('Error getting "add control" form: '+h.statusText);var g=h.argument;g.destroy()},argument:a};Fisma.SecurityAuthorization.addControlPanel=a;YAHOO.util.Connect.asyncRequest("GET",b,c,null)}};