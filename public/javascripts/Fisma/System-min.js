Fisma.System={uploadDocumentCallback:function(a){window.location.href=window.location.href},removeSelectedUsers:function(b,a){var d=[];var c=new Object();$('input:checkbox[name="rolesAndUsers[][]"]:checked').each(function(){if($(this).val()!==""){d.push($(this).val())}});c.organizationId=a.organizationId;c.userRoles=d;c.csrf=$('[name="csrf"]').val();$.ajax({type:"POST",url:"/user/remove-user-roles/",data:c,dataType:"json",success:function(){$("#rolesAndUsers").load("/system/get-user-access-tree/id/"+c.organizationId+"/name/rolesAndUsers")}})},addUser:function(b,a){var c=new Object();c.userId=$("#addUserId").val();c.roleId=$("#roles").val();c.organizationId=a.organizationId;c.csrf=$('[name="csrf"]').val();$.ajax({type:"POST",url:"/system/add-user/",data:c,dataType:"json",success:function(){$("#rolesAndUsers").load("/system/get-user-access-tree/id/"+c.organizationId+"/name/rolesAndUsers")}})},addSelectedUsers:function(b,a){var d=[];var c=new Object();$('input:checkbox[name="copyUserAccessTree[][]"]:checked').each(function(){if($(this).val()!==""){d.push($(this).val())}});c.userRoles=d;c.organizationId=a.organizationId;c.csrf=$('[name="csrf"]').val();$.ajax({type:"POST",url:"/user/add-user-roles-to-organization/",data:c,dataType:"json",success:function(){$("#rolesAndUsers").load("/system/get-user-access-tree/id/"+c.organizationId+"/name/rolesAndUsers")}})},convertToOrganization:function(f,d){var c="WARNING: You are about to convert this system to an organization. After this conversion all system information (FIPS-199 and FISMA Data) will be permanently lost.\n\nDo you want to continue?";var h=function(){Fisma.System.showWaitPanelWhileConverting();this.hide();document.location="/system/convert-to-org/id/"+d.id};var b=function(){this.destroy()};var g=[{text:"Yes",handler:h},{text:"No",handler:b}];var e={width:"300px",fixedcenter:true,visible:false,draggable:false,close:true,modal:true,text:c,icon:YAHOO.widget.SimpleDialog.ICON_WARN,constraintoviewport:true,buttons:g};var a=new YAHOO.widget.SimpleDialog("warningDialog",e);a.setHeader("Are you sure?");a.render(document.body);a.show()},convertToSystem:function(b,a){Fisma.Util.showConfirmDialog(b,{text:"Are you sure you want to convert this organization to a system?",func:"Fisma.System.askForOrgToSysInput",args:[a.id]})},askForOrgToSysInput:function(sysId){var panel;var populateForm=function(){var scriptNodes=panel.body.getElementsByTagName("script");for(var i=0;i<scriptNodes.length;i++){try{eval(scriptNodes[i].text)}catch(e){var message="Not able to execute one of the scripts embedded in this page: "+e.message;Fisma.Util.showAlertDialog(message)}}var tooltips=YAHOO.util.Dom.getElementsByClassName("yui-tt","div");for(var index in tooltips){var tooltip=tooltips[index];tooltip.style.zIndex=5}};var panelConfig={width:"50em",modal:true};panel=Fisma.UrlPanel.showPanel("Convert Organization To System","/organization/convert-to-system-form/format/html/id/"+sysId,populateForm,"convertToSystemPanel",panelConfig)},getSystemConversionForm:function(g){var e=function(m,l,n){var p=document.createElement("tr");var o=document.createElement("td");var k=document.createTextNode(l+":");o.appendChild(k);var j=document.createElement("td");j.align="right";j.appendChild(b(l,n));p.appendChild(o);p.appendChild(j);m.appendChild(p)};var b=function(m,k){var p=document.createElement("select");p.name=m.replace(" ","");for(var j=0;j<k.length;j++){var n=document.createElement("option");n.value=k[j];var l=document.createTextNode(k[j]);var o=document.createElement("b");o.appendChild(l);n.appendChild(o);p.appendChild(n)}return p};var h=document.createElement("form");h.id="sysConversionForm";h.method="post";h.action="/organization/convert-to-system/id/"+g;var i=document.createElement("div");i.className="hd";i.appendChild(document.createTextNode("System information"));var f=document.createElement("div");f.className="bd";var c=document.createTextNode("Please input the needed system information in order to complete conversion.");f.appendChild(c);f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));var d=document.createElement("table");d.width="100%";e(d,"Type",["gss","major","minor"]);e(d,"SDLC Phase",["initiation","development","implementation","operations","disposal"]);e(d,"Confidentiality",["NA","HIGH","MODERATE","LOW"]);e(d,"Integrity",["HIGH","MODERATE","LOW"]);e(d,"Availability",["HIGH","MODERATE","LOW"]);f.appendChild(d);h.appendChild(i);h.appendChild(f);var a=document.createElement("input");a.type="hidden";a.value=$('[name="csrf"]').val();a.name="csrf";h.appendChild(a);return h},showWaitPanelWhileConverting:function(){var a=new YAHOO.widget.Panel("savePanel",{width:"250px",fixedcenter:true,close:false,draggable:false,modal:true,visible:true});a.setHeader("Converting...");a.setBody('<img src="/images/loading_bar.gif">');a.render(document.body);a.show()}};