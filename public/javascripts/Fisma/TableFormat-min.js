Fisma.TableFormat={greenColor:"lightgreen",yellowColor:"yellow",redColor:"pink",green:function(a){a.style.backgroundColor=Fisma.TableFormat.greenColor},yellow:function(a){a.style.backgroundColor=Fisma.TableFormat.yellowColor},red:function(a){a.style.backgroundColor=Fisma.TableFormat.redColor},securityAuthorization:function(b,a,c,d){b.innerHTML=d;dateParts=d.split("-");if(3==dateParts.length){authorizedDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-30);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-36);if(authorizedDate>=greenDate){Fisma.TableFormat.green(b.parentNode)}else{if(authorizedDate>=yellowDate){Fisma.TableFormat.yellow(b.parentNode)}else{Fisma.TableFormat.red(b.parentNode)}}}},selfAssessment:function(b,a,c,d){b.innerHTML=d;dateParts=d.split("-");if(3==dateParts.length){assessmentDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-8);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-12);if(assessmentDate>=greenDate){Fisma.TableFormat.green(b.parentNode)}else{if(assessmentDate>=yellowDate){Fisma.TableFormat.yellow(b.parentNode)}else{Fisma.TableFormat.red(b.parentNode)}}}},contingencyPlanTest:function(b,a,c,d){Fisma.TableFormat.selfAssessment(b,a,c,d)},yesNo:function(b,a,c,d){b.innerHTML=d;if("YES"==d){Fisma.TableFormat.green(b.parentNode)}else{if("NO"==d){Fisma.TableFormat.red(b.parentNode)}}},editControl:function(d,c,e,f){var a=document.createElement("img");a.src="/images/edit.png";var b=document.createElement("a");b.href=f;b.appendChild(a);d.appendChild(b)},deleteControl:function(d,c,e,f){var a=document.createElement("img");a.src="/images/del.png";var b=document.createElement("a");b.href=f;b.appendChild(a);d.appendChild(b)},formatHtml:function(a,b,c,d){a.innerHTML=d.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},overdueFinding:function(g,i,d,b){overdueFindingSearchUrl="/finding/remediation/list/advanced";var a=i.getData("System");if(a){overdueFindingSearchUrl+="/organization/textExactMatch/"+escape(a)}var c=i.getData("Status");if(c){overdueFindingSearchUrl+="/denormalizedStatus/textExactMatch/"+escape(c)}var h=d.formatterParameters;if(h.source){overdueFindingSearchUrl+="/source/textExactMatch/"+escape(h.source)}var f=null;if(h.from){fromDate=new Date();console.log(fromDate);fromDate.setDate(fromDate.getDate()-parseInt(h.from));console.log(fromDate);console.log(parseInt(h.from));f=fromDate.getFullYear()+"-"+(fromDate.getMonth()+1)+"-"+fromDate.getDate()}var e=null;if(h.to){toDate=new Date();toDate.setDate(toDate.getDate()-parseInt(h.to));e=toDate.getFullYear()+"-"+(toDate.getMonth()+1)+"-"+toDate.getDate()}if(f&&e){overdueFindingSearchUrl+="/nextDueDate/dateBetween/"+e+"/"+f}else{if(f){overdueFindingSearchUrl+="/nextDueDate/dateBefore/"+f}}g.innerHTML="<a href="+overdueFindingSearchUrl+">"+b+"</a>"},completeDocTypePercentage:function(b,a,c,d){b.innerHTML=d;percentage=parseInt(d.replace(/%/g,""));if(percentage!=null){if(percentage>=95&&percentage<=100){Fisma.TableFormat.green(b.parentNode)}else{if(percentage>=80&&percentage<95){Fisma.TableFormat.yellow(b.parentNode)}else{if(percentage>=0&&percentage<80){Fisma.TableFormat.red(b.parentNode)}}}}},incompleteDocumentType:function(c,b,d,e){var a="";if(e.length>0){a+="<ul><li>"+e.replace(/,/g,"</li><li>")+"</li></ul>"}c.innerHTML=a}};