tinyMCE.init({theme:"advanced",mode:"textareas",cleanup:false,element_format:"html",plugins:"spellchecker, searchreplace, insertdatetime, print, fullscreen",plugin_insertdate_dateFormat:"%Y-%m-%d",plugin_insertdate_timeFormat:"%H:%M:%S",browsers:"msie,gecko,safari,opera",theme_advanced_buttons1:"bold, italic, underline, |, bullist, numlist, |, outdent, indent, |, cut, copy, paste, |, undo, redo, |, spellchecker, |, search, replace, |, insertdate, inserttime, link, unlink, |, print, fullscreen",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true,spellchecker_rpc_url:"/javascripts/tiny_mce/plugins/spellchecker/rpc.php",spellchecker_languages:"+English=en"});var requiredMajorVersion=9;var requiredMinorVersion=0;var requiredRevision=45;var Fisma={};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var readyFunc=function(){var g=YAHOO.util.Selector.query(".date");for(var b=0;b<g.length;b++){YAHOO.util.Event.on(g[b].getAttribute("id")+"_show","click",callCalendar,g[b].getAttribute("id"))}var a=function(){if(document.getElementById("remediationSearchAging")){var k=document.getElementById("remediationSearchAging").value.trim()}else{return}var h=document.getElementById("created_date_begin");var j=document.getElementById("created_date_end");if(k=="0"){h.disabled=false;j.disabled=false;document.getElementById("show1").disabled=false;document.getElementById("show2").disabled=false}else{h.disabled=true;j.disabled=true;h.value="";j.value="";document.getElementById("show1").disabled=true;document.getElementById("show2").disabled=true}};YAHOO.util.Event.on("remediationSearchAging","change",a);a();var f=function(){if(document.getElementById("created_date_begin")&&document.getElementById("created_date_end")){var j=document.getElementById("created_date_begin").value.trim();var h=document.getElementById("created_date_end").value.trim()}else{return}if(j!=""||h!=""){document.getElementById("remediationSearchAging").disabled=true}else{document.getElementById("remediationSearchAging").disabled=false}};YAHOO.util.Event.on("created_date_begin","change",f);YAHOO.util.Event.on("created_date_end","change",f);f();var d=function(){if(document.getElementById("encrypt")){var j=document.getElementById("encrypt")}else{return}var h=j.value.trim();if(h=="sha256"){j.style.display=""}else{j.style.display="none"}};YAHOO.util.Event.on("encrypt","change",d);d();YAHOO.util.Event.on("function_screen","change",search_function);search_function();YAHOO.util.Event.on("add_function","click",function(){var h=new YAHOO.util.Selector.query("#availableFunctions option");for(var j=0;j<h.length;j++){if(h[j].selected==true){document.getElementById("existFunctions").appendChild(h[j])}}return false});YAHOO.util.Event.on("remove_function","click",function(){var h=YAHOO.util.Selector.query("#existFunctions option");for(var j=0;j<h.length;j++){if(h[j].selected==true){document.getElementById("availableFunctions").appendChild(h[j])}}return false});YAHOO.util.Event.on(YAHOO.util.Selector.query("form[name=assign_right]"),"submit",function(){var h=YAHOO.util.Selector.query("#existFunctions option");for(var j=0;j<h.length;j++){h[j].selected=true}});YAHOO.util.Event.on("searchAsset","click",searchAsset);YAHOO.util.Event.on("search_product","click",searchProduct);YAHOO.util.Event.on(YAHOO.util.Selector.query(".confirm"),"click",function(){var h="DELETING CONFIRMATION!";if(confirm(h)==true){return true}return false});asset_detail();getProdId()};function search_function(){var f=YAHOO.util.Selector.query("select[name=function_screen]");if(f==""){return}var k=name="";var d=YAHOO.util.Selector.query("select[name=function_screen] option");for(var g=0;g<d.length;g++){if(d[g].selected==true){name=d[g].text}}if(""!=name){k+="/screen_name/"+name}var b=YAHOO.util.Selector.query("#existFunctions option");var j="";for(var g=0;g<b.length;g++){if(g==0){j+=b[g].value}else{j+=","+b[g].value}}var a=document.getElementById("function_screen").getAttribute("url")+"/do/availableFunctions"+k+"/existFunctions/"+j;var h=YAHOO.util.Connect.asyncRequest("GET",a,{success:function(l){document.getElementById("availableFunctions").parentNode.innerHTML='<select style="width: 250px;" name="availableFunctions" id="availableFunctions" size="20" multiple="">'+l.responseText+"</select>"},failure:handleFailure})}var handleFailure=function(a){alert("error")};function upload_evidence(){if(!form_confirm(document.finding_detail,"Upload Evidence")){return false}document.finding_detail.enctype="multipart/form-data";panel("Upload Evidence",document.finding_detail,"/remediation/upload-form");return false}function ev_approve(f){if(!form_confirm(document.finding_detail,"approve the evidence package")){return false}var d=document.createElement("div");var g=document.createElement("p");g.appendChild(document.createTextNode("Comments (OPTIONAL):"));d.appendChild(g);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";d.appendChild(b);var h=document.createElement("div");h.style.height="20px";d.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";d.appendChild(a);panel("Evidence Approval",document.finding_detail,"",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=f;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}k.elements.comment.value=l;k.elements.decision.value="APPROVED";var j=document.createElement("input");j.type="hidden";j.name="submit_ea";j.value="APPROVED";k.appendChild(j);k.submit()}}function ev_deny(f){if(!form_confirm(document.finding_detail,"deny the evidence package")){return false}var d=document.createElement("div");var g=document.createElement("p");g.appendChild(document.createTextNode("Comments:"));d.appendChild(g);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";d.appendChild(b);var h=document.createElement("div");h.style.height="20px";d.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";d.appendChild(a);panel("Evidence Denial",document.finding_detail,"",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=f;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}if(l.match(/^\s*$/)){alert("Comments are required in order to deny.");return}k.elements.comment.value=l;k.elements.decision.value="DENIED";var j=document.createElement("input");j.type="hidden";j.name="submit_ea";j.value="DENIED";k.appendChild(j);k.submit()}}function ms_approve(f){if(!form_confirm(document.finding_detail,"approve the mitigation strategy")){return false}var d=document.createElement("div");var g=document.createElement("p");var h=document.createTextNode("Comments (OPTIONAL):");g.appendChild(h);d.appendChild(g);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;d.appendChild(a);var j=document.createElement("div");j.style.height="20px";d.appendChild(j);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";d.appendChild(b);panel("Mitigation Strategy Approval",document.finding_detail,"",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var l=f;if(document.all){var m=document.getElementById("dialog_comment").innerHTML}else{var m=document.getElementById("dialog_comment").value}l.elements.comment.value=m;l.elements.decision.value="APPROVED";var k=document.createElement("input");k.type="hidden";k.name="submit_msa";k.value="APPROVED";l.appendChild(k);l.submit()}}function ms_deny(f){if(!form_confirm(document.finding_detail,"deny the mitigation strategy")){return false}var d=document.createElement("div");var g=document.createElement("p");var h=document.createTextNode("Comments:");g.appendChild(h);d.appendChild(g);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;d.appendChild(a);var j=document.createElement("div");j.style.height="20px";d.appendChild(j);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";d.appendChild(b);panel("Mitigation Strategy Denial",document.finding_detail,"",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var l=f;if(document.all){var m=document.getElementById("dialog_comment").innerHTML}else{var m=document.getElementById("dialog_comment").value}if(m.match(/^\s*$/)){alert("Comments are required in order to submit.");return}l.elements.comment.value=m;l.elements.decision.value="DENIED";var k=document.createElement("input");k.type="hidden";k.name="submit_msa";k.value="DENIED";l.appendChild(k);l.submit()}}function getProdId(){var a=document.getElementById("productId");YAHOO.util.Event.on(a,"change",function(){document.getElementById("productId").value=a.value})}var searchProduct=function(){var d=document.getElementById("search_product");var b=d.getAttribute("url");var a=YAHOO.util.Selector.query("input.product");for(var f=0;f<a.length;f++){if(a[f].value!=undefined&&a[f].value!=""){b+="/"+a[f].name+"/"+a[f].value}}YAHOO.util.Connect.asyncRequest("GET",b,{success:function(g){document.getElementById("productId").parentNode.innerHTML=g.responseText;document.getElementById("productId").style.width="400px";getProdId()},failure:handleFailure})};var searchAsset=function(){var b=new YAHOO.util.Element("orgSystemId");if(b.get("id")==undefined){return}var g=b.get("value");var h="";if(0!=parseInt(g)){h+="/system_id/"+g}var f=YAHOO.util.Selector.query("input.assets");for(var d=0;d<f.length;d++){if(f[d].value!=undefined&&f[d].value!=""){h+="/"+f[d].name+"/"+f[d].value}}var a=document.getElementById("orgSystemId").getAttribute("url")+h;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(l){document.getElementById("assetId").options.length=0;var j=YAHOO.lang.JSON.parse(l.responseText);j=j.table.records;for(var k=0;k<j.length;k++){document.getElementById("assetId").options.add(new Option(j[k].name,j[k].id))}},failure:handleFailure})};function asset_detail(){YAHOO.util.Event.on("assetId","change",function(){var a=this.getAttribute("url")+this.value;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(b){document.getElementById("asset_info").innerHTML=b.responseText},failure:handleFailure})})}function message(d,a){if(document.getElementById("msgbar")){var b=document.getElementById("msgbar")}else{return}if(b.innerHTML){b.innerHTML=b.innerHTML+d}else{b.innerHTML=d}b.style.fontWeight="bold";if(a=="warning"){b.style.color="red"}else{b.style.color="green";b.style.borderColor="green";b.style.backgroundColor="lightgreen"}b.style.display="block"}function toggleSearchOptions(b){var a=document.getElementById("advanced_searchbox");if(a.style.display=="none"){a.style.display="";b.value="Basic Search"}else{a.style.display="none";b.value="Advanced Search"}}function showJustification(){if(document.getElementById("ecd_justification")){document.getElementById("ecd_justification").style.display=""}}function addBookmark(f,d){if(window.sidebar){window.sidebar.addPanel(d.title,d.href,"")}else{if(window.opera){var b=document.createElement("A");b.rel="sidebar";b.target="_search";b.title=d.title;b.href=d.href;b.click()}else{if(document.all){window.external.AddFavorite(d.href,d.title)}else{alert("Your browser does not support automatic bookmarks. Please try to bookmark this page manually instead.")}}}}function highlight(d,b){if(""==b){return}b.sort();b.reverse();for(var a in b){highlightWord(d,b[a])}}function highlightWord(d,a){if(d&&d.hasChildNodes){var b;for(b=0;b<d.childNodes.length;b++){highlightWord(d.childNodes[b],a)}}if(d&&d.nodeType==3){tempNodeVal=d.nodeValue.toLowerCase();tempWordVal=a.toLowerCase();if(tempNodeVal.indexOf(tempWordVal)!=-1){pn=d.parentNode;if(pn.className!="highlight"){nv=d.nodeValue;ni=tempNodeVal.indexOf(tempWordVal);before=document.createTextNode(nv.substr(0,ni));docWordVal=nv.substr(ni,a.length);after=document.createTextNode(nv.substr(ni+a.length));hiwordtext=document.createTextNode(docWordVal);hiword=document.createElement("span");hiword.className="highlight";hiword.appendChild(hiwordtext);pn.insertBefore(before,d);pn.insertBefore(hiword,d);pn.insertBefore(after,d);pn.removeChild(d)}}}}function removeHighlight(b){if(b.hasChildNodes){var a;for(a=0;a<b.childNodes.length;a++){removeHighlight(b.childNodes[a])}}if(b.nodeType==3){pn=b.parentNode;if(pn.className=="highlight"){prevSib=pn.previousSibling;nextSib=pn.nextSibling;nextSib.nodeValue=prevSib.nodeValue+b.nodeValue+nextSib.nodeValue;prevSib.nodeValue="";b.nodeValue=""}}}function switchYear(f){if(!isFinite(f)){f=0}var g=document.getElementById("gen_shortcut");var d=g.getAttribute("year");d=Number(d)+Number(f);g.setAttribute("year",d);var a=g.getAttribute("url")+d+"/";var b=YAHOO.util.Selector.query("#gen_shortcut span:nth-child(1)");b[0].innerHTML=d;b[0].parentNode.setAttribute("href",a);b[1].parentNode.setAttribute("href",a+"q/1/");b[2].parentNode.setAttribute("href",a+"q/2/");b[3].parentNode.setAttribute("href",a+"q/3/");b[4].parentNode.setAttribute("href",a+"q/4/")}function form_confirm(h,g){var k=false;elements=YAHOO.util.Selector.query("[name*='finding']");for(var b=0;b<elements.length;b++){var j=elements[b].tagName.toUpperCase();if(j=="INPUT"){var a=elements[b].type;if(a=="text"||a=="password"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}if(d!=elements[b].value){}}if(a=="checkbox"||a=="radio"){var d=elements[b].checked?"on":"off";if(d!=elements[b].getAttribute("_value")){k=true}}}else{if(j=="SELECT"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}if(d!=elements[b].options[elements[b].selectedIndex].value){k=true}}else{if(j=="TEXTAREA"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}var f=elements[b].value?elements[b].value:elements[b].innerHTML;if(d!=f){k=true}}}}}if(k){if(confirm('WARNING: You have unsaved changes on the page. If you continue, these changes will be lost. If you want to save your changes, click "Cancel" now and then click "Save Changes".')){return true}else{return false}}if(confirm("WARNING: You are about to "+g+'. This action cannot be undone. Please click "Ok" to confirm your action or click "Cancel" to stop.')){return true}return false}function dump(a){var b=""+a;for(i in a){if("function"!=typeof(a[i])){b+=i+" : "+a[i]+"\n"}}alert(b)}function panel(g,d,f,b,h){var a=new YAHOO.widget.Panel("panel",{width:"540px",modal:true});a.setHeader(g);a.setBody("Loading...");a.render(d);a.center();a.show();if(f!=""){YAHOO.util.Connect.asyncRequest("GET",f,{success:function(j){j.argument.setBody(j.responseText);j.argument.center();if(h){h()}},failure:function(j){alert("Failed to load the specified panel.")},argument:a},null)}else{a.setBody(b);a.center()}}var e=YAHOO.util.Event;e.onDOMReady(readyFunc);function callCalendar(a,b){showCalendar(b,b+"_show")}function showCalendar(g,d){var m=YAHOO.util.Event,j=YAHOO.util.Dom,k,h;var l=j.get(d);var k;var h;if(!k){function f(){j.get(g).value="";a()}function a(){k.hide()}k=new YAHOO.widget.Dialog("container",{visible:false,context:[g,"tl","bl"],draggable:true,close:true});k.setHeader("Pick A Date");k.setBody('<div id="cal"></div><div class="clear"></div>');k.render(document.body);dialogEl=document.getElementById("container");dialogEl.style.padding="0px";k.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){k.fireEvent("changeContent")}})}if(!h){h=new YAHOO.widget.Calendar("cal",{iframe:false,hide_blank_weeks:true});h.render();h.selectEvent.subscribe(function(){if(h.getSelectedDates().length>0){var o=h.getSelectedDates()[0];var n=(o.getDate()<10)?"0"+o.getDate():o.getDate();var q=(o.getMonth()+1<10)?"0"+(o.getMonth()+1):(o.getMonth()+1);var p=o.getFullYear();j.get(g).value=p+"-"+q+"-"+n}else{j.get(g).value=""}k.hide();if("finding[currentEcd]"==j.get(g).name){validateEcd()}});h.renderEvent.subscribe(function(){k.fireEvent("changeContent")})}var b=h.getSelectedDates();if(b.length>0){h.cfg.setProperty("pagedate",b[0]);h.render()}k.show()}YAHOO.namespace("fisma.CheckboxTree");YAHOO.fisma.CheckboxTree.rootNode;YAHOO.fisma.CheckboxTree.handleClick=function(l,d){if(d.altKey){return}var j=l.parentNode;var m=j.nextSibling.childNodes[0];if(m.getAttribute("nestedLevel")>l.getAttribute("nestedLevel")){var a=l.getAttribute("nestedlevel");var f=new Array();var n=true;var b=j.nextSibling;var k=b.childNodes[0];while(k.getAttribute("nestedLevel")>a){if(!k.checked){n=false}f.push(k);if(b.nextSibling){b=b.nextSibling;k=b.childNodes[0]}else{break}}if(n){l.checked=false}else{l.checked=true}for(var g in f){var h=f[g];if(n){h.checked=false}else{h.checked=true}}}};function setupEditFields(){var a=YAHOO.util.Selector.query(".editable");YAHOO.util.Event.on(a,"click",function(g){removeHighlight(document);var k=this.getAttribute("target");YAHOO.util.Dom.removeClass(this,"editable");this.removeAttribute("target");if(k){var l=document.getElementById(k);var b=l.getAttribute("name");var m=l.getAttribute("type");var d=l.getAttribute("href");var j=l.className;var f=l.innerText?l.innerText:l.textContent;var n=l.innerHTML;if(m=="text"){l.outerHTML='<input length="50" name="'+b+'" id="'+k+'" class="'+j+'" type="text" value="'+f.trim()+'" />';if(j=="date"){var l=document.getElementById(k);l.onfocus=function(){showCalendar(k,k+"_show")};calendarIcon=document.createElement("img");calendarIcon.id=k+"_show";calendarIcon.src="/images/calendar.gif";calendarIcon.alt="Calendar";l.parentNode.appendChild(calendarIcon);YAHOO.util.Event.on(k+"_show","click",function(){showCalendar(k,k+"_show")})}}else{if(m=="textarea"){var p=l.getAttribute("rows");var h=l.getAttribute("cols");l.outerHTML='<textarea id="'+b+'" rows="'+p+'" cols="'+h+'" name="'+b+'">'+n+"</textarea>";tinyMCE.execCommand("mceAddControl",true,b)}else{YAHOO.util.Connect.asyncRequest("GET",d+"value/"+f.trim(),{success:function(q){if(m=="select"){l.outerHTML='<select name="'+b+'">'+q.responseText+"</select>"}},failure:function(q){alert("Failed to load the specified panel.")}},null)}}}})}function validateEcd(){var g=document.getElementById("expectedCompletionDate");var d=g.value;var f=new Date();var a=f.getFullYear();var b=f.getMonth();b=b+1;if(b<10){b="0"+b}var h=f.getDate();if(h<10){h="0"+h}if(d.replace(/\-/g,"")<=parseInt(""+a+""+b+""+h)){alert("Warning: You entered an ECD date in the past.")}}if(window.HTMLElement){HTMLElement.prototype.__defineSetter__("outerHTML",function(b){var a=this.ownerDocument.createRange();a.setStartBefore(this);var d=a.createContextualFragment(b);this.parentNode.replaceChild(d,this);return b});HTMLElement.prototype.__defineGetter__("outerHTML",function(){var a;var b=this.attributes;var f="<"+this.tagName.toLowerCase();for(var d=0;d<b.length;d++){a=b[d];if(a.specified){f+=" "+a.name+'="'+a.value+'"'}}if(!this.canHaveChildren){return f+">"}return f+">"+this.innerHTML+"</"+this.tagName.toLowerCase()+">"});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){switch(this.tagName.toLowerCase()){case"area":case"base":case"basefont":case"col":case"frame":case"hr":case"img":case"br":case"input":case"isindex":case"link":case"meta":case"param":return false}return true})}var helpPanels=new Array();function showHelp(b,d){if(helpPanels[d]){helpPanels[d].show()}else{var a=new YAHOO.widget.Panel("helpPanel",{width:"400px"});a.setHeader("Help");a.setBody("Loading...");a.render(document.body);a.center();a.show();YAHOO.util.Connect.asyncRequest("GET","/help/help/module/"+d,{success:function(f){f.argument.setBody(f.responseText);f.argument.center()},failure:function(f){alert("Failed to load the help module.")},argument:a},null);helpPanels[d]=a}}function selectAllUnsafe(){var a=YAHOO.util.Dom.getElementsBy(function(b){return(b.tagName=="INPUT"&&b.type=="checkbox")});for(i in a){a[i].checked="checked"}}function selectAll(){alert("Not implemented")}function selectNoneUnsafe(){var a=YAHOO.util.Dom.getElementsBy(function(b){return(b.tagName=="INPUT"&&b.type=="checkbox")});for(i in a){a[i].checked=""}}function selectNone(){alert("Not implemented")}function elDump(a){props="";for(prop in a){props+=prop+" : "+a[prop]+"\n"}alert(props)}function delok(b){var a="Are you sure that you want to delete this "+b+"?";if(confirm(a)==true){return true}return false}function GeneratePassword(){var a=document.getElementById("generate_password");YAHOO.util.Connect.asyncRequest("GET","/user/generate-password/format/html",{success:function(b){document.getElementById("password").value=b.responseText;document.getElementById("confirmPassword").value=b.responseText},failure:function(b){alert("Failed to generate password: "+b.statusText)}},null);return false}var check_account=function(){var b=document.getElementById("username").value;b=encodeURIComponent(b);var a="/user/check-account/format/json/account/"+b;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(f){var d=YAHOO.lang.JSON.parse(f.responseText);message(d.msg,d.type)},failure:function(d){alert("Failed to generate password: "+d.statusText)}},null);return false};var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var a;var b;var d;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");a=b.GetVariable("$version")}catch(d){}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a="WIN 6,0,21,0";b.AllowScriptAccess="always";a=b.GetVariable("$version")}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a=b.GetVariable("$version")}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a="WIN 3,0,18,0"}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a="WIN 2,0,0,11"}catch(d){a=-1}}return a}function GetSwfVer(){var j=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var h=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var a=navigator.plugins["Shockwave Flash"+h].description;var g=a.split(" ");var d=g[2].split(".");var k=d[0];var b=d[1];var f=g[3];if(f==""){f=g[4]}if(f[0]=="d"){f=f.substring(1)}else{if(f[0]=="r"){f=f.substring(1);if(f.indexOf("d")>0){f=f.substring(0,f.indexOf("d"))}}}var j=k+"."+b+"."+f}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){j=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){j=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){j=2}else{if(isIE&&isWin&&!isOpera){j=ControlVersion()}}}}}return j}function DetectFlashVer(h,f,d){versionStr=GetSwfVer();if(versionStr==-1){return false}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var g=versionArray[0];var a=versionArray[1];var b=versionArray[2];if(g>parseFloat(h)){return true}else{if(g==parseFloat(h)){if(a>parseFloat(f)){return true}else{if(a==parseFloat(f)){if(b>=parseFloat(d)){return true}}}}}return false}}}function AC_AddExtension(b,a){if(b.indexOf("?")!=-1){return b.replace(/\?/,a+"?")}else{return b+a}}function AC_Generateobj(g,f,a){var d="";if(isIE&&isWin&&!isOpera){d+="<object ";for(var b in g){d+=b+'="'+g[b]+'" '}d+=">";for(var b in f){d+='<param name="'+b+'" value="'+f[b]+'" /> '}d+="</object>"}else{d+="<embed ";for(var b in a){d+=b+'="'+a[b]+'" '}d+="> </embed>"}document.write(d)}function AC_FL_RunContent(){var a=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_SW_RunContent(){var a=AC_GetArgs(arguments,".dcr","src","clsid:166B1BCA-3F9C-11CF-8075-444553540000",null);AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_GetArgs(b,g,j,f,k){var a=new Object();a.embedAttrs=new Object();a.params=new Object();a.objAttrs=new Object();for(var d=0;d<b.length;d=d+2){var h=b[d].toLowerCase();switch(h){case"classid":break;case"pluginspage":a.embedAttrs[b[d]]=b[d+1];break;case"src":case"movie":b[d+1]=AC_AddExtension(b[d+1],g);a.embedAttrs.src=b[d+1];a.params[j]=b[d+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblclick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":a.objAttrs[b[d]]=b[d+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":a.embedAttrs[b[d]]=a.objAttrs[b[d]]=b[d+1];break;default:a.embedAttrs[b[d]]=a.params[b[d]]=b[d+1]}}a.objAttrs.classid=f;if(k){a.embedAttrs.type=k}return a}Fisma.AutoComplete=function(){return{init:function(a,g,f){var d=new YAHOO.widget.DS_XHR(f.xhr,f.schema);d.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;d.maxCacheEntries=500;d.queryMatchContains=true;var b=new YAHOO.widget.AutoComplete(f.fieldId,f.containerId,d);b.maxResultsDisplayed=20;b.forceSelection=true;b.generateRequest=function(h){return f.queryPrepend+'"'+h+'"'};b.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:f.hiddenFieldId})},subscribe:function(d,b,a){document.getElementById(a.hiddenFieldId).value=b[2][1]["id"]}}}();Fisma.Email=function(){return{showRecipientDialog:function(){var b=document.getElementById("tabContainer");if(document.getElementById("panel_c")){b.removeChild(document.getElementById("panel_c"))}var f=document.createElement("div");var j=document.createElement("p");var d=document.createTextNode("* Target E-mail Address:");j.appendChild(d);f.appendChild(j);var g=document.createElement("input");g.id="testEmailRecipient";g.name="recipient";f.appendChild(g);var h=document.createElement("div");h.style.height="10px";f.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialogRecipientSendBtn";a.style.marginLeft="10px";a.value="Send";f.appendChild(a);panel("Test E-mail Configuration",b,"",f.innerHTML);document.getElementById("dialogRecipientSendBtn").onclick=Fisma.Email.sendTestEmail},sendTestEmail:function(){if(document.getElementById("testEmailRecipient").value==""){alert("Recipient is required.");document.getElementById("testEmailRecipient").focus();return false}var b=document.getElementById("testEmailRecipient").value;var a=document.getElementById("email_config");a.elements.recipient.value=b;YAHOO.util.Connect.setForm(a);YAHOO.util.Connect.asyncRequest("POST","/config/test-email-config/format/json",{success:function(g){var f=YAHOO.lang.JSON.parse(g.responseText);message(f.msg,f.type)},failure:function(f){alert("Failed to send mail: "+f.statusText)}},null);var d=document.getElementById("panel_mask");d.style.visibility="hidden";document.getElementById("tabContainer").removeChild(document.getElementById("panel_c"))}}}();Fisma.FindingSummary=function(){return{treeRoot:null,filterType:null,filterSource:null,defaultDisplayLevel:2,render:function(j,k,u){if(u){this.treeRoot=k}var q=document.getElementById(j);for(var g in k){var m=k[g];var a=q.insertRow(q.rows.length);a.id=m.nickname+"_ontime";var f=q.insertRow(q.rows.length);f.id=m.nickname+"_overdue";var b=a.insertCell(0);m.expanded=(m.level<this.defaultDisplayLevel-1);var p=m.expanded?m.single_ontime:m.all_ontime;var l=m.expanded?m.single_overdue:m.all_overdue;m.hasOverdue=this.hasOverdue(l);var r=document.createElement("img");r.className="control";r.id=m.nickname+"Img";var h=document.createElement("a");h.appendChild(r);var o=m.children.length>0;if(o){h.nickname=m.nickname;h.findingSummary=this;h.onclick=function(){this.findingSummary.toggleNode(this.nickname);return false};r.src="/images/"+(m.expanded?"minus.png":"plus.png")}else{r.src="/images/leaf_node.png"}var d=document.createElement("div");d.className="treeTable"+m.level+(o?" link":"");d.appendChild(h);var t=document.createElement("img");t.className="icon";t.src="/images/"+m.orgType+".png";h.appendChild(t);h.appendChild(document.createTextNode(m.label));h.appendChild(document.createElement("br"));h.appendChild(document.createTextNode(m.orgTypeLabel));b.appendChild(d);var n=1;for(var s in p){count=p[s];cell=a.insertCell(n++);if(s=="CLOSED"||s=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}this.updateCellCount(cell,count,m.id,s,"ontime",m.expanded)}for(var s in l){count=l[s];cell=f.insertCell(f.childNodes.length);cell.className="overdue";this.updateCellCount(cell,count,m.id,s,"overdue",m.expanded)}a.style.display="none";f.style.display="none";if(m.level<this.defaultDisplayLevel){a.style.display="";if(m.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";f.style.display=""}}if(m.children.length>0){this.render(j,m.children)}}},toggleNode:function(a){node=this.findNode(a,this.treeRoot);if(node.expanded){this.collapseNode(node,true);this.hideSubtree(node.children)}else{this.expandNode(node);this.showSubtree(node.children,false)}},expandNode:function(g,b){g.ontime=g.single_ontime;g.overdue=g.single_overdue;g.hasOverdue=this.hasOverdue(g.overdue);var a=document.getElementById(g.nickname+"_ontime");var d=1;for(c in g.ontime){count=g.ontime[c];this.updateCellCount(a.childNodes[d],count,g.id,c,"ontime",true);d++}var f=document.getElementById(g.nickname+"_overdue");if(g.hasOverdue){var d=0;for(c in g.overdue){count=g.overdue[c];this.updateCellCount(f.childNodes[d],count,g.id,c,"overdue",true);d++}}else{a.childNodes[0].rowSpan="1";a.childNodes[a.childNodes.length-2].rowSpan="1";a.childNodes[a.childNodes.length-1].rowSpan="1";f.style.display="none"}if(g.children.length>0){document.getElementById(g.nickname+"Img").src="/images/minus.png"}g.expanded=true;if(b&&g.children.length>0){this.showSubtree(g.children,false);for(var h in g.children){this.expandNode(g.children[h],true)}}},collapseNode:function(g,b){g.ontime=g.all_ontime;g.overdue=g.all_overdue;g.hasOverdue=this.hasOverdue(g.overdue);var a=document.getElementById(g.nickname+"_ontime");var d=1;for(c in g.ontime){count=g.ontime[c];this.updateCellCount(a.childNodes[d],count,g.id,c,"ontime",false);d++}var f=document.getElementById(g.nickname+"_overdue");if(b&&g.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";f.style.display="";var d=0;for(c in g.all_overdue){count=g.all_overdue[c];this.updateCellCount(f.childNodes[d],count,g.id,c,"overdue",false);d++}}if(g.children.length>0){this.hideSubtree(g.children)}document.getElementById(g.nickname+"Img").src="/images/plus.png";g.expanded=false},hideSubtree:function(a){for(nodeId in a){node=a[nodeId];ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"_overdue");overdueRow.style.display="none";if(node.children.length>0){this.collapseNode(node,false);this.hideSubtree(node.children)}}},showSubtree:function(b,a){for(nodeId in b){node=b[nodeId];if(a&&node.children.length>0){this.expandNode(node);this.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"_overdue");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}},collapseAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.collapseNode(node,true);this.hideSubtree(node.children)}},expandAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.expandNode(node,true)}},findNode:function(f,b){for(var d in b){node=b[d];if(node.nickname==f){return node}else{if(node.children.length>0){var a=this.findNode(f,node.children);if(a!=false){return a}}}}return false},hasOverdue:function(b){for(var a in b){if(b[a]>0){return true}}return false},updateCellCount:function(a,h,d,b,j,f){if(!a.hasChildNodes()){if(h>0){var g=document.createElement("a");g.href=this.makeLink(d,b,j,f);g.appendChild(document.createTextNode(h));a.appendChild(g)}else{a.appendChild(document.createTextNode("-"))}}else{if(a.firstChild.hasChildNodes()){if(h>0){a.firstChild.firstChild.nodeValue=h;a.firstChild.href=this.makeLink(d,b,j,f)}else{a.removeChild(a.firstChild);a.appendChild(document.createTextNode("-"))}}else{if(h>0){a.removeChild(a.firstChild);var g=document.createElement("a");g.href=this.makeLink(d,b,j,f);g.appendChild(document.createTextNode(h));a.appendChild(g)}else{a.firstChild.nodeValue="-"}}}},makeLink:function(g,h,l,k){var f="";if(!(h=="CLOSED"||h=="TOTAL")){var f="/ontime/"+l}var j="";if(h!=""){j="/status/"+escape(h)}var a="";if(!YAHOO.lang.isNull(this.filterType)&&this.filterType!=""){a="/type/"+this.filterType}var b="";if(!YAHOO.lang.isNull(this.filterSource)&&this.filterSource!=""){b="/sourceId/"+this.filterSource}var d="/panel/remediation/sub/search"+f+j+"/responsibleOrganizationId/"+g+"/expanded/"+k+a+b;return d},exportTable:function(b){var a="/remediation/summary-data/format/"+b+this.listExpandedNodes(this.treeRoot,"");document.location=a},listExpandedNodes:function(b,a){for(var f in b){var d=b[f];if(d.expanded){a+="/e/"+d.id;a=this.listExpandedNodes(d.children,a)}else{a+="/c/"+d.id}}return a}}};